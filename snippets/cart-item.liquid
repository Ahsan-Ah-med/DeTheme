{%- liquid 
  assign item_id  = item.id
  assign item_key = item.key
  assign item_url = item.url
  assign image    = item.image
  assign item_qty = item.quantity
  assign item_variant = item.variant
  assign item_pr = item.product
  assign min_qty = item_pr.metafields.theme.cus_qty | default:min_qty
  if item_variant.inventory_management != null and item_variant.inventory_management != blank and item_variant.inventory_quantity > 0 and item_variant.inventory_policy != 'continue'
    assign max_qty = item_variant.inventory_quantity
  else
    assign max_qty = 9999
  endif -%}

 <div data-cart-item data-pid="{{item.product_id}}" class="sr4-mini_cart__item cart_item_{{item_id}} sr4-d-flex sr4-align-items-start sr4-pr sr4-oh{% if gift_pr_id == item.product_id %} is--gift{% endif %}">
    <a href="{{item_url}}" class="sr4-mini_cart__img sr4-pr sr4-oh sr4_ratio sr4-bg-11" style="background: url({{ image | image_url: width: 1 }});--aspect-ratioapt:{{image.aspect_ratio |default: 1}}">
      {%- if image != blank -%}
        <img class="lazyloadsr4" width="120" height="{{ 120 | divided_by: image.aspect_ratio | ceil }}" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="{{ image | image_url: width: 1 }}" data-widths="[120, 240]" data-sizes="auto" alt="{{ image.alt | escape }}">
      {%- endif -%}
      <div class="sr4-cart-ld__bar sr4-pe-none sr4-dn" hidden><span>
        <svg width="16" height="16" hidden class="sr4-cart-spinner" focusable="false" role="presentation" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">
          <circle class="sr4-path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
        </svg>
        <svg class="sr4-cart-check" viewBox="0 0 448 512" width="16" height="16" hidden><use href="#icon-cart-check"/></svg>
      </span></div>
    </a>
    <div class="sr4-mini_cart__info">
       <a href="{{item_url}}" class="sr4-mini_cart__title sr4-truncate">{{ item_pr.title }}</a>
       <div class="sr4-mini_cart__meta">
          {%- assign qv_key = item_pr.id -%}
          {%- unless item_pr.has_only_default_variant or item_variant.title contains 'mczr_price_' -%}{%- assign qv_key = item_id -%}<p class="sr4-cart_meta_variant">{{ item_variant.title }}</p>{%- endunless -%}
          {%- if item.selling_plan_allocation != blank %}<p class="sr4-cart_selling_plan">{{ item.selling_plan_allocation.selling_plan.name }}</p>{% endif -%}
          {%- assign property_size = item.properties | size -%}
          {%- if property_size > 0 -%}
          <ul class="sr4-cart_meta_propertyList">
            {%- for p in item.properties -%}

                {%- liquid
                  assign p_first = p.first
                  assign p_last  = p.last
                  assign first_character_in_key = p_first | slice: 0
                  if p_first contains '_bundle_' or p_first contains '_mczr_' or first_character_in_key == '_' or p_last == blank
                      continue
                  endif
                  if p_first == 'shipping_interval_frequency'
                      assign frequency = p_last
                      assign recurringchecked = true
                      continue 
                  elsif p_first == 'shipping_interval_unit_type'
                      if frequency == '1'
                          if p_last == 'Days'
                              assign frequency_unit = 'Day'
                          elsif p_last == 'Months'
                              assign frequency_unit = 'Month'
                          elsif p_last == 'Weeks'
                              assign frequency_unit = 'Week'
                          endif
                      else
                          assign frequency_unit = p_last
                      endif
                      continue
                  endif -%}
                
                <li class="sr4-product-details__item product-details__item--property">
                  <span class="sr4-product-details__item-label"><strong>{{ p_first }}:</strong> </span>
                  <span>
                    {%- if p_last contains '/uploads/' -%}
                      <a href="{{ p_last }}">{{ p_last | split: '/' | last }}</a>
                    {%- else -%}
                      {{p_last }}
                    {%- endif -%}
                  </span>
                </li>

            {%- endfor -%}
          </ul>
          {%- endif -%}
          {%- if recurringchecked %}<span class="sr4-product-details__item-recurring sr4-ch">{{ 'cart.general.recurring_mess' | t:frequency:frequency,frequency_unit:frequency_unit }}</span>{% endif -%}
          <div class="sr4-cart_meta_price">
              <div class="sr4-cart_price">
                <span class="money">
                {%- unless cart_ajax_enable %}{{item_qty}} Ã— {% endunless -%}
                {%- liquid
                 assign original_price     = item.original_price
                 assign final_price        = item.final_price
                 assign v_compare_at_price = item_variant.compare_at_price 
                 assign item_compare_price = v_compare_at_price | default:original_price |times:item_qty
                 assign compare_tt_price   = compare_tt_price | plus:item_compare_price
                 if cur_code_enabled
                   assign money_original_price = original_price | money_with_currency
                   assign money_final_price    = final_price | money_with_currency
                 else
                   assign money_original_price = original_price | money
                   assign money_final_price    = final_price | money
                 endif -%}

                {%- if original_price != final_price -%}
                   <del>{{ money_original_price }}</del><ins>{{ money_final_price }}</ins>
                {%- elsif v_compare_at_price > original_price  -%}
                   <del>{% if cur_code_enabled %}{{ v_compare_at_price | money_with_currency }}{% else %}{{ v_compare_at_price | money }}{% endif %}</del><ins>{{ money_final_price }}</ins>
                {%- else -%}
                   {{ money_original_price }}
                {%- endif -%}
                  </span>
              </div>
              {%- if item.unit_price_measurement -%}
                 {%- capture unit_price_base_unit -%}
                   {%- if item.unit_price_measurement.reference_value != 1 -%}
                     {{- item.unit_price_measurement.reference_value -}}
                   {%- endif -%}
                   {{ item.unit_price_measurement.reference_unit }}
                 {%- endcapture -%}
                 <div class="sr4-cart_unit_price">{{ item.unit_price | money }}<span>/</span>{{- unit_price_base_unit -}}</div>
              {%- endif -%}
              {%- if item.line_level_discount_allocations != blank -%}
                 <ul class="sr4-cart_discount_price">
                    {%- for discount_allocation in item.line_level_discount_allocations -%}
                      <li class="sr4-order-discount__item"><svg viewBox="0 0 24 24" width="20"><use href="#icon-cart-tag"/></svg> {{ discount_allocation.discount_application.title }} (-{{ discount_allocation.amount | money }})</li>
                    {%- endfor -%}
                 </ul>
              {%- endif -%}
          </div>
       </div>
       <div class="sr4-mini_cart__actions">
          {%- if cart_ajax_enable -%}
          <div data-quantity-wrapper class="sr4-quantity-wrapper sr4-quantity-cart-item"> 
            {% comment %}<button data-quantity-selector data-decrease-qty type="button" class="sr4-quantity-selector is--minus">{% if item_qty > 1 or min_qty == 1 %}<svg focusable="false" class="icon icon--minus" viewBox="0 0 10 2" role="presentation"><path d="M10 0v2H0V0z" fill="currentColor"></path></svg>{% else %}<svg viewBox="0 0 24 24" width="17"><use href="#icon-cart-remove"/></svg>{% endif %}</button>{% endcomment %}
            <button data-quantity-selector data-decrease-qty type="button" class="sr4-quantity-selector is--minus"><svg role="presentation" focusable="false" class="icon icon--minus" width="7" height="2" viewBox="0 0 7 2" fill="none" xmlns="http://www.w3.org/2000/svg">
            <line x1="0.351562" y1="0.880243" x2="6.54355" y2="0.880243" stroke="#1E1E1E" style="stroke:#1E1E1E;stroke:color(display-p3 0.1176 0.1176 0.1176);stroke-opacity:1;" stroke-width="1.13258"/>
            </svg></button>
            <input data-action-change data-quantity-value type="number" id="miniupdates_{{item_key}}" data-id="{{item_key}}" class="aaa sr4-quantity-input" step="1" min="{{min_qty}}" max="{{max_qty}}" name="updates[]" data-current-qty="{{ item_qty }}" value="{{ item_qty }}" size="4" pattern="[0-9]*" inputmode="numeric">
            <button data-quantity-selector data-increase-qty type="button" class="sr4-quantity-selector is--plus">
              {% comment %}<svg focusable="false" class="icon icon--plus" viewBox="0 0 10 10" role="presentation"><path d="M6 4h4v2H6v4H4V6H0V4h4V0h2v4z" fill="currentColor" fill-rule="evenodd"></path></svg>{% endcomment %}
              <svg focusable="false" class="icon icon--plus" role="presentation" width="8" height="7" viewBox="0 0 8 7" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.77102 3.13065V0.228717H4.68707V3.13065H7.61575V4.0467H4.68707V6.94864H3.77102V4.0467H0.849025V3.13065H3.77102Z" fill="#1E1E1E" style="fill:#1E1E1E;fill:color(display-p3 0.1176 0.1176 0.1176);fill-opacity:1;"/>
              </svg>
            </button>
          </div>
          {%- endif -%}
          <div class="replace_ajax_buttonss">
            {%- if item_pr.has_only_default_variant == false and atc_ajax_enable -%}
            <a href="{{item_url}}" rel="nofollow" class="sr4-mini_cart__edit" data-action-quickshop data-edit="{{edit_item}}" data-id="{{qv_key}}" data-key="{{item_key}}" data-no-instant data-id="{{qv_key}}" data-tooltip="top-start" data-sr4-tooltip='{{ 'cart.general.edit_item' | t | escape }}'>
              {% comment %}<svg viewBox="0 0 24 24" width="20" height="20"><use href="#icon-cart-edit"/></svg>{% endcomment %}
              <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M16.667 19H2.00033V4.33333H10.8137L12.147 3H2.00033C1.6467 3 1.30756 3.14048 1.05752 3.39052C0.807468 3.64057 0.666992 3.97971 0.666992 4.33333V19C0.666992 19.3536 0.807468 19.6928 1.05752 19.9428C1.30756 20.1929 1.6467 20.3333 2.00033 20.3333H16.667C17.0206 20.3333 17.3598 20.1929 17.6098 19.9428C17.8598 19.6928 18.0003 19.3536 18.0003 19V9L16.667 10.3333V19Z" fill="black" style="fill:black;fill-opacity:1;"/>
                <path d="M20.3536 2.89338L18.107 0.646711C18.0073 0.546731 17.8888 0.467407 17.7584 0.413283C17.628 0.359159 17.4882 0.331299 17.347 0.331299C17.2058 0.331299 17.066 0.359159 16.9355 0.413283C16.8051 0.467407 16.6867 0.546731 16.587 0.646711L7.44696 9.84004L6.70696 13.0467C6.67544 13.2021 6.67875 13.3626 6.71667 13.5166C6.75458 13.6707 6.82616 13.8143 6.92625 13.9374C7.02633 14.0604 7.15244 14.1597 7.29551 14.2282C7.43857 14.2967 7.59503 14.3326 7.75363 14.3334C7.83561 14.3424 7.91832 14.3424 8.0003 14.3334L11.2336 13.62L20.3536 4.41338C20.4536 4.31367 20.5329 4.19522 20.5871 4.0648C20.6412 3.93439 20.669 3.79458 20.669 3.65338C20.669 3.51218 20.6412 3.37237 20.5871 3.24195C20.5329 3.11154 20.4536 2.99308 20.3536 2.89338ZM10.5403 12.3867L8.1003 12.9267L8.66696 10.5067L15.547 3.58004L17.427 5.46004L10.5403 12.3867ZM18.1803 4.70671L16.3003 2.82671L17.3336 1.77338L19.227 3.66671L18.1803 4.70671Z" fill="black" style="fill:black;fill-opacity:1;"/>
              </svg>
              </a>
            {%- endif -%}
            <a href="{{cart_change_url}}?quantity=0&amp;id={{item_key}}" rel="nofollow" class="sr4-mini_cart__remove" data-no-instant data-cart-remove data-id="{{item_key}}" data-tooltip="top-start" data-sr4-tooltip='{{ 'cart.general.remove_item' | t | escape }}'>
              {% comment %}<svg viewBox="0 0 24 24" width="17"><use href="#icon-cart-remove"/></svg>{% endcomment %}
              <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M17.3612 3.6665H1.30566M15.7868 6.02761L15.3524 12.5443C15.1852 15.0508 15.1021 16.3041 14.2852 17.0682C13.4682 17.8322 12.2112 17.8332 9.69894 17.8332H8.96794C6.45572 17.8332 5.19866 17.8332 4.38172 17.0682C3.56478 16.3041 3.48072 15.0508 3.3145 12.5443L2.88005 6.02761" stroke="black" style="stroke:black;stroke-opacity:1;" stroke-width="1.41667" stroke-linecap="round"/>
                <path d="M4.13965 3.66683H4.24354C4.62363 3.65712 4.99194 3.53293 5.3003 3.3105C5.60866 3.08808 5.84272 2.77777 5.97187 2.42016L6.00398 2.32289L6.09559 2.04805C6.17398 1.81288 6.21365 1.69577 6.26559 1.59566C6.36779 1.39959 6.51446 1.23015 6.69388 1.10092C6.87329 0.971693 7.08046 0.886253 7.29882 0.851441C7.40932 0.833496 7.53304 0.833496 7.78048 0.833496H10.8877C11.1351 0.833496 11.2589 0.833496 11.3694 0.851441C11.5877 0.886253 11.7949 0.971693 11.9743 1.10092C12.1537 1.23015 12.3004 1.39959 12.4026 1.59566C12.4545 1.69577 12.4942 1.81288 12.5726 2.04805L12.6642 2.32289C12.7839 2.72075 13.0314 3.06806 13.3685 3.31102C13.7055 3.55398 14.1132 3.67904 14.5285 3.66683" stroke="black" style="stroke:black;stroke-opacity:1;" stroke-width="1.41667"/>
              </svg>
              </a>
          </div>
       </div>
    </div>
 </div>